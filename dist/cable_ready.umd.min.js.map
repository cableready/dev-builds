{"version":3,"file":"cable_ready.umd.min.js","sources":["../javascript/enums.js","../javascript/active_element.js","../javascript/utils.js","../javascript/morph_callbacks.js","../javascript/operations.js","../javascript/operation_store.js","../node_modules/@msgpack/msgpack/dist.es5+esm/utils/utf8.mjs","../node_modules/@msgpack/msgpack/dist.es5+esm/utils/int.mjs","../node_modules/@msgpack/msgpack/dist.es5+esm/ExtData.mjs","../node_modules/@msgpack/msgpack/dist.es5+esm/DecodeError.mjs","../node_modules/@msgpack/msgpack/dist.es5+esm/timestamp.mjs","../node_modules/@msgpack/msgpack/dist.es5+esm/ExtensionCodec.mjs","../node_modules/@msgpack/msgpack/dist.es5+esm/utils/typedArrays.mjs","../node_modules/@msgpack/msgpack/dist.es5+esm/utils/prettyByte.mjs","../node_modules/@msgpack/msgpack/dist.es5+esm/CachedKeyDecoder.mjs","../node_modules/@msgpack/msgpack/dist.es5+esm/Decoder.mjs","../node_modules/@msgpack/msgpack/dist.es5+esm/decode.mjs","../javascript/cable_ready.js","../javascript/cable_consumer.js","../javascript/elements/cable_ready_element.js","../javascript/elements/subscribing_element.js","../javascript/elements/stream_from_element.js","../javascript/elements/updates_for_element.js","../javascript/updatable/inner_updates_compat.js","../javascript/index.js","../javascript/elements/index.js"],"sourcesContent":["export const inputTags = {\n  INPUT: true,\n  TEXTAREA: true,\n  SELECT: true\n}\n\nexport const mutableTags = {\n  INPUT: true,\n  TEXTAREA: true,\n  OPTION: true\n}\n\nexport const textInputTypes = {\n  'datetime-local': true,\n  'select-multiple': true,\n  'select-one': true,\n  color: true,\n  date: true,\n  datetime: true,\n  email: true,\n  month: true,\n  number: true,\n  password: true,\n  range: true,\n  search: true,\n  tel: true,\n  text: true,\n  textarea: true,\n  time: true,\n  url: true,\n  week: true\n}\n","let activeElement\n\nexport default {\n  get element () {\n    return activeElement\n  },\n  set (element) {\n    activeElement = element\n  }\n}\n","import { inputTags, textInputTypes } from './enums'\nimport ActiveElement from './active_element'\n\n// Indicates if the passed element is considered a text input.\n//\nconst isTextInput = element => {\n  return inputTags[element.tagName] && textInputTypes[element.type]\n}\n\n// Assigns focus to the appropriate element... preferring the explicitly passed selector\n//\n// * selector - a CSS selector for the element that should have focus\n//\nconst assignFocus = selector => {\n  const element =\n    selector && selector.nodeType === Node.ELEMENT_NODE\n      ? selector\n      : document.querySelector(selector)\n  const focusElement = element || ActiveElement.element\n  if (focusElement && focusElement.focus) focusElement.focus()\n}\n\n// Dispatches an event on the passed element\n//\n// * element - the element\n// * name - the name of the event\n// * detail - the event detail\n//\nconst dispatch = (element, name, detail = {}) => {\n  const init = { bubbles: true, cancelable: true, detail: detail }\n  const evt = new CustomEvent(name, init)\n  element.dispatchEvent(evt)\n  if (window.jQuery) window.jQuery(element).trigger(name, detail)\n}\n\n// Accepts an xPath query and returns the element found at that position in the DOM\n//\nconst xpathToElement = xpath => {\n  return document.evaluate(\n    xpath,\n    document,\n    null,\n    XPathResult.FIRST_ORDERED_NODE_TYPE,\n    null\n  ).singleNodeValue\n}\n\n// Accepts an xPath query and returns all matching elements in the DOM\n//\nconst xpathToElementArray = xpath => {\n  const result = document.evaluate(\n    xpath,\n    document,\n    null,\n    XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,\n    null\n  )\n  const elements = []\n  for (let i = 0; i < result.snapshotLength; i++)\n    elements.push(result.snapshotItem(i))\n  return elements\n}\n\n// Return an array with the class names to be used\n//\n// * names - could be a string or an array of strings for multiple classes.\n//\nconst getClassNames = names => Array.from(names).flat()\n\n// Perform operation for either the first or all of the elements returned by CSS selector\n//\n// * operation - the instruction payload from perform\n// * callback - the operation function to run for each element\n//\nconst processElements = (operation, callback) => {\n  Array.from(\n    operation.selectAll ? operation.element : [operation.element]\n  ).forEach(callback)\n}\n\n// camelCase to kebab-case\n//\nconst kebabize = str => {\n  return str\n    .split('')\n    .map((letter, idx) => {\n      return letter.toUpperCase() === letter\n        ? `${idx !== 0 ? '-' : ''}${letter.toLowerCase()}`\n        : letter\n    })\n    .join('')\n}\n\n// Provide a standardized pipeline of checks and modifications to all operations based on provided options\n// Currently skips execution if cancelled and implements an optional delay\n//\nconst operate = (operation, callback) => {\n  if (!operation.cancel) {\n    operation.delay ? setTimeout(callback, operation.delay) : callback()\n    return true\n  }\n  return false\n}\n\n// Dispatch life-cycle events with standardized naming\nconst before = (target, operation) =>\n  dispatch(\n    target,\n    `cable-ready:before-${kebabize(operation.operation)}`,\n    operation\n  )\n\nconst after = (target, operation) =>\n  dispatch(\n    target,\n    `cable-ready:after-${kebabize(operation.operation)}`,\n    operation\n  )\n\nfunction debounce (func, timeout) {\n  let timer\n  return (...args) => {\n    clearTimeout(timer)\n    timer = setTimeout(() => func.apply(this, args), timeout)\n  }\n}\n\nfunction handleErrors (response) {\n  if (!response.ok) throw Error(response.statusText)\n  return response\n}\n\nfunction safeScalar (val) {\n  if (\n    val !== undefined &&\n    !['string', 'number', 'boolean'].includes(typeof val)\n  )\n    console.warn(\n      `Operation expects a string, number or boolean, but got ${val} (${typeof val})`\n    )\n  return val != null ? val : ''\n}\n\nfunction safeString (str) {\n  if (str !== undefined && typeof str !== 'string')\n    console.warn(`Operation expects a string, but got ${str} (${typeof str})`)\n  return str != null ? String(str) : ''\n}\n\nfunction safeArray (arr) {\n  if (arr !== undefined && !Array.isArray(arr))\n    console.warn(`Operation expects an array, but got ${arr} (${typeof arr})`)\n  return arr != null ? Array.from(arr) : []\n}\n\nfunction safeObject (obj) {\n  if (obj !== undefined && typeof obj !== 'object')\n    console.warn(`Operation expects an object, but got ${obj} (${typeof obj})`)\n  return obj != null ? Object(obj) : {}\n}\n\n// A proxy method to wrap a fetch call in error handling\n//\n// * url - the URL to fetch\n// * additionalHeaders - an object of additional headers passed to fetch\n//\nasync function graciouslyFetch (url, additionalHeaders) {\n  try {\n    const response = await fetch(url, {\n      headers: {\n        'X-REQUESTED-WITH': 'XmlHttpRequest',\n        ...additionalHeaders\n      }\n    })\n    if (response == undefined) return\n\n    handleErrors(response)\n\n    return response\n  } catch (e) {\n    console.error(`Could not fetch ${url}`)\n  }\n}\n\nexport {\n  isTextInput,\n  assignFocus,\n  dispatch,\n  xpathToElement,\n  xpathToElementArray,\n  getClassNames,\n  processElements,\n  operate,\n  before,\n  after,\n  debounce,\n  handleErrors,\n  graciouslyFetch,\n  kebabize,\n  safeScalar,\n  safeString,\n  safeArray,\n  safeObject\n}\n","import { mutableTags } from './enums'\nimport { isTextInput } from './utils'\nimport ActiveElement from './active_element'\n\n// Indicates whether or not we should morph an element via onBeforeElUpdated callback\n// SEE: https://github.com/patrick-steele-idem/morphdom#morphdomfromnode-tonode-options--node\n//\nconst shouldMorph = operation => (fromEl, toEl) => {\n  return !shouldMorphCallbacks\n    .map(callback => {\n      return typeof callback === 'function'\n        ? callback(operation, fromEl, toEl)\n        : true\n    })\n    .includes(false)\n}\n\n// Execute any pluggable functions that modify elements after morphing via onElUpdated callback\n//\nconst didMorph = operation => el => {\n  didMorphCallbacks.forEach(callback => {\n    if (typeof callback === 'function') callback(operation, el)\n  })\n}\n\nconst verifyNotMutable = (detail, fromEl, toEl) => {\n  // Skip nodes that are equal:\n  // https://github.com/patrick-steele-idem/morphdom#can-i-make-morphdom-blaze-through-the-dom-tree-even-faster-yes\n  if (!mutableTags[fromEl.tagName] && fromEl.isEqualNode(toEl)) return false\n  return true\n}\n\nconst verifyNotContentEditable = (detail, fromEl, toEl) => {\n  if (fromEl === ActiveElement.element && fromEl.isContentEditable) return false\n  return true\n}\n\nconst verifyNotPermanent = (detail, fromEl, toEl) => {\n  const { permanentAttributeName } = detail\n  if (!permanentAttributeName) return true\n\n  const permanent = fromEl.closest(`[${permanentAttributeName}]`)\n\n  // only morph attributes on the active non-permanent text input\n  if (!permanent && fromEl === ActiveElement.element && isTextInput(fromEl)) {\n    const ignore = { value: true }\n    Array.from(toEl.attributes).forEach(attribute => {\n      if (!ignore[attribute.name])\n        fromEl.setAttribute(attribute.name, attribute.value)\n    })\n    return false\n  }\n\n  return !permanent\n}\n\nconst shouldMorphCallbacks = [\n  verifyNotMutable,\n  verifyNotPermanent,\n  verifyNotContentEditable\n]\nconst didMorphCallbacks = []\n\nexport {\n  shouldMorphCallbacks,\n  didMorphCallbacks,\n  shouldMorph,\n  didMorph,\n  verifyNotMutable,\n  verifyNotContentEditable,\n  verifyNotPermanent\n}\n","import morphdom from 'morphdom'\nimport { shouldMorph, didMorph } from './morph_callbacks'\nimport {\n  assignFocus,\n  dispatch,\n  getClassNames,\n  processElements,\n  before,\n  after,\n  operate,\n  safeScalar,\n  safeString,\n  safeArray,\n  safeObject\n} from './utils'\n\nexport default {\n  // DOM Mutations\n\n  append: operation => {\n    processElements(operation, element => {\n      before(element, operation)\n      operate(operation, () => {\n        const { html, focusSelector } = operation\n        element.insertAdjacentHTML('beforeend', safeScalar(html))\n        assignFocus(focusSelector)\n      })\n      after(element, operation)\n    })\n  },\n\n  graft: operation => {\n    processElements(operation, element => {\n      before(element, operation)\n      operate(operation, () => {\n        const { parent, focusSelector } = operation\n        const parentElement = document.querySelector(parent)\n        if (parentElement) {\n          parentElement.appendChild(element)\n          assignFocus(focusSelector)\n        }\n      })\n      after(element, operation)\n    })\n  },\n\n  innerHtml: operation => {\n    processElements(operation, element => {\n      before(element, operation)\n      operate(operation, () => {\n        const { html, focusSelector } = operation\n        element.innerHTML = safeScalar(html)\n        assignFocus(focusSelector)\n      })\n      after(element, operation)\n    })\n  },\n\n  insertAdjacentHtml: operation => {\n    processElements(operation, element => {\n      before(element, operation)\n      operate(operation, () => {\n        const { html, position, focusSelector } = operation\n        element.insertAdjacentHTML(position || 'beforeend', safeScalar(html))\n        assignFocus(focusSelector)\n      })\n      after(element, operation)\n    })\n  },\n\n  insertAdjacentText: operation => {\n    processElements(operation, element => {\n      before(element, operation)\n      operate(operation, () => {\n        const { text, position, focusSelector } = operation\n        element.insertAdjacentText(position || 'beforeend', safeScalar(text))\n        assignFocus(focusSelector)\n      })\n      after(element, operation)\n    })\n  },\n\n  morph: operation => {\n    processElements(operation, element => {\n      const { html } = operation\n      const template = document.createElement('template')\n      template.innerHTML = String(safeScalar(html)).trim()\n      operation.content = template.content\n      const parent = element.parentElement\n      const ordinal = Array.from(parent.children).indexOf(element)\n      before(element, operation)\n      operate(operation, () => {\n        const { childrenOnly, focusSelector } = operation\n        morphdom(\n          element,\n          childrenOnly ? template.content : template.innerHTML,\n          {\n            childrenOnly: !!childrenOnly,\n            onBeforeElUpdated: shouldMorph(operation),\n            onElUpdated: didMorph(operation)\n          }\n        )\n        assignFocus(focusSelector)\n      })\n      after(parent.children[ordinal], operation)\n    })\n  },\n\n  outerHtml: operation => {\n    processElements(operation, element => {\n      const parent = element.parentElement\n      const ordinal = Array.from(parent.children).indexOf(element)\n      before(element, operation)\n      operate(operation, () => {\n        const { html, focusSelector } = operation\n        element.outerHTML = safeScalar(html)\n        assignFocus(focusSelector)\n      })\n      after(parent.children[ordinal], operation)\n    })\n  },\n\n  prepend: operation => {\n    processElements(operation, element => {\n      before(element, operation)\n      operate(operation, () => {\n        const { html, focusSelector } = operation\n        element.insertAdjacentHTML('afterbegin', safeScalar(html))\n        assignFocus(focusSelector)\n      })\n      after(element, operation)\n    })\n  },\n\n  remove: operation => {\n    processElements(operation, element => {\n      before(element, operation)\n      operate(operation, () => {\n        const { focusSelector } = operation\n        element.remove()\n        assignFocus(focusSelector)\n      })\n      after(document, operation)\n    })\n  },\n\n  replace: operation => {\n    processElements(operation, element => {\n      const parent = element.parentElement\n      const ordinal = Array.from(parent.children).indexOf(element)\n      before(element, operation)\n      operate(operation, () => {\n        const { html, focusSelector } = operation\n        element.outerHTML = safeScalar(html)\n        assignFocus(focusSelector)\n      })\n      after(parent.children[ordinal], operation)\n    })\n  },\n\n  textContent: operation => {\n    processElements(operation, element => {\n      before(element, operation)\n      operate(operation, () => {\n        const { text, focusSelector } = operation\n        element.textContent = safeScalar(text)\n        assignFocus(focusSelector)\n      })\n      after(element, operation)\n    })\n  },\n\n  // Element Property Mutations\n\n  addCssClass: operation => {\n    processElements(operation, element => {\n      before(element, operation)\n      operate(operation, () => {\n        const { name } = operation\n        element.classList.add(...getClassNames([safeString(name)]))\n      })\n      after(element, operation)\n    })\n  },\n\n  removeAttribute: operation => {\n    processElements(operation, element => {\n      before(element, operation)\n      operate(operation, () => {\n        const { name } = operation\n        element.removeAttribute(safeString(name))\n      })\n      after(element, operation)\n    })\n  },\n\n  removeCssClass: operation => {\n    processElements(operation, element => {\n      before(element, operation)\n      operate(operation, () => {\n        const { name } = operation\n        element.classList.remove(...getClassNames([safeString(name)]))\n      })\n      after(element, operation)\n    })\n  },\n\n  setAttribute: operation => {\n    processElements(operation, element => {\n      before(element, operation)\n      operate(operation, () => {\n        const { name, value } = operation\n        element.setAttribute(safeString(name), safeScalar(value))\n      })\n      after(element, operation)\n    })\n  },\n\n  setDatasetProperty: operation => {\n    processElements(operation, element => {\n      before(element, operation)\n      operate(operation, () => {\n        const { name, value } = operation\n        element.dataset[safeString(name)] = safeScalar(value)\n      })\n      after(element, operation)\n    })\n  },\n\n  setProperty: operation => {\n    processElements(operation, element => {\n      before(element, operation)\n      operate(operation, () => {\n        const { name, value } = operation\n        if (name in element) element[safeString(name)] = safeScalar(value)\n      })\n      after(element, operation)\n    })\n  },\n\n  setStyle: operation => {\n    processElements(operation, element => {\n      before(element, operation)\n      operate(operation, () => {\n        const { name, value } = operation\n        element.style[safeString(name)] = safeScalar(value)\n      })\n      after(element, operation)\n    })\n  },\n\n  setStyles: operation => {\n    processElements(operation, element => {\n      before(element, operation)\n      operate(operation, () => {\n        const { styles } = operation\n        for (let [name, value] of Object.entries(styles))\n          element.style[safeString(name)] = safeScalar(value)\n      })\n      after(element, operation)\n    })\n  },\n\n  setValue: operation => {\n    processElements(operation, element => {\n      before(element, operation)\n      operate(operation, () => {\n        const { value } = operation\n        element.value = safeScalar(value)\n      })\n      after(element, operation)\n    })\n  },\n\n  // DOM Events and Meta-Operations\n\n  dispatchEvent: operation => {\n    processElements(operation, element => {\n      before(element, operation)\n      operate(operation, () => {\n        const { name, detail } = operation\n        dispatch(element, safeString(name), safeObject(detail))\n      })\n      after(element, operation)\n    })\n  },\n\n  invokeMethod: operation => {\n    processElements(operation, element => {\n      before(element, operation)\n      operate(operation, () => {\n        let firstObjectInChain\n        const { element, receiver, method, args } = operation\n        const chain = safeString(method).split('.')\n\n        switch (receiver) {\n          case 'window':\n            firstObjectInChain = window\n            break\n          case 'document':\n            firstObjectInChain = document\n            break\n          default:\n            firstObjectInChain = element\n        }\n        let lastObjectInChain = firstObjectInChain\n        const foundMethod = chain.reduce((lastTerm, nextTerm) => {\n          lastObjectInChain = lastTerm\n          return lastTerm[nextTerm] || {}\n        }, firstObjectInChain)\n\n        if (foundMethod instanceof Function) {\n          foundMethod.apply(lastObjectInChain, args || [])\n        } else {\n          console.warn(\n            `CableReady invoke_method operation failed due to missing '${method}' method for:`,\n            firstObjectInChain\n          )\n        }\n      })\n      after(element, operation)\n    })\n  },\n\n  setMeta: operation => {\n    before(document, operation)\n    operate(operation, () => {\n      const { name, content } = operation\n      let meta = document.head.querySelector(`meta[name='${name}']`)\n      if (!meta) {\n        meta = document.createElement('meta')\n        meta.name = safeString(name)\n        document.head.appendChild(meta)\n      }\n      meta.content = safeScalar(content)\n    })\n    after(document, operation)\n  },\n\n  // Browser Manipulations\n\n  clearStorage: operation => {\n    before(document, operation)\n    operate(operation, () => {\n      const { type } = operation\n      const storage = type === 'session' ? sessionStorage : localStorage\n      storage.clear()\n    })\n    after(document, operation)\n  },\n\n  go: operation => {\n    before(window, operation)\n    operate(operation, () => {\n      const { delta } = operation\n      history.go(delta)\n    })\n    after(window, operation)\n  },\n\n  pushState: operation => {\n    before(window, operation)\n    operate(operation, () => {\n      const { state, title, url } = operation\n      history.pushState(safeObject(state), safeString(title), safeString(url))\n    })\n    after(window, operation)\n  },\n\n  redirectTo: operation => {\n    before(window, operation)\n    operate(operation, () => {\n      let { url, action, turbo } = operation\n      action = action || 'advance'\n      url = safeString(url)\n      if (turbo === undefined) turbo = true\n\n      if (turbo) {\n        if (window.Turbo) window.Turbo.visit(url, { action })\n        if (window.Turbolinks) window.Turbolinks.visit(url, { action })\n        if (!window.Turbo && !window.Turbolinks) window.location.href = url\n      } else {\n        window.location.href = url\n      }\n    })\n    after(window, operation)\n  },\n\n  reload: operation => {\n    before(window, operation)\n    operate(operation, () => {\n      window.location.reload()\n    })\n    after(window, operation)\n  },\n\n  removeStorageItem: operation => {\n    before(document, operation)\n    operate(operation, () => {\n      const { key, type } = operation\n      const storage = type === 'session' ? sessionStorage : localStorage\n      storage.removeItem(safeString(key))\n    })\n    after(document, operation)\n  },\n\n  replaceState: operation => {\n    before(window, operation)\n    operate(operation, () => {\n      const { state, title, url } = operation\n      history.replaceState(\n        safeObject(state),\n        safeString(title),\n        safeString(url)\n      )\n    })\n    after(window, operation)\n  },\n\n  scrollIntoView: operation => {\n    const { element } = operation\n    before(element, operation)\n    operate(operation, () => {\n      element.scrollIntoView(operation)\n    })\n    after(element, operation)\n  },\n\n  setCookie: operation => {\n    before(document, operation)\n    operate(operation, () => {\n      const { cookie } = operation\n      document.cookie = safeScalar(cookie)\n    })\n    after(document, operation)\n  },\n\n  setFocus: operation => {\n    const { element } = operation\n    before(element, operation)\n    operate(operation, () => {\n      assignFocus(element)\n    })\n    after(element, operation)\n  },\n\n  setStorageItem: operation => {\n    before(document, operation)\n    operate(operation, () => {\n      const { key, value, type } = operation\n      const storage = type === 'session' ? sessionStorage : localStorage\n      storage.setItem(safeString(key), safeScalar(value))\n    })\n    after(document, operation)\n  },\n\n  // Notifications\n\n  consoleLog: operation => {\n    before(document, operation)\n    operate(operation, () => {\n      const { message, level } = operation\n      level && ['warn', 'info', 'error'].includes(level)\n        ? console[level](message)\n        : console.log(message)\n    })\n    after(document, operation)\n  },\n\n  consoleTable: operation => {\n    before(document, operation)\n    operate(operation, () => {\n      const { data, columns } = operation\n      console.table(data, safeArray(columns))\n    })\n    after(document, operation)\n  },\n\n  notification: operation => {\n    before(document, operation)\n    operate(operation, () => {\n      const { title, options } = operation\n      Notification.requestPermission().then(result => {\n        operation.permission = result\n        if (result === 'granted')\n          new Notification(safeString(title), safeObject(options))\n      })\n    })\n    after(document, operation)\n  }\n}\n","import Operations from './operations'\n\nlet operations = Operations\n\nconst add = newOperations => {\n  operations = { ...operations, ...newOperations }\n}\n\nconst addOperations = operations => {\n  add(operations)\n}\n\nconst addOperation = (name, operation) => {\n  const operations = {}\n  operations[name] = operation\n\n  add(operations)\n}\n\nexport { addOperation, addOperations }\n\nexport default {\n  get all () {\n    return operations\n  }\n}\n","var _a, _b, _c;\n/* eslint-disable @typescript-eslint/no-unnecessary-condition */\nimport { UINT32_MAX } from \"./int.mjs\";\nvar TEXT_ENCODING_AVAILABLE = (typeof process === \"undefined\" || ((_a = process === null || process === void 0 ? void 0 : process.env) === null || _a === void 0 ? void 0 : _a[\"TEXT_ENCODING\"]) !== \"never\") &&\n    typeof TextEncoder !== \"undefined\" &&\n    typeof TextDecoder !== \"undefined\";\nexport function utf8Count(str) {\n    var strLength = str.length;\n    var byteLength = 0;\n    var pos = 0;\n    while (pos < strLength) {\n        var value = str.charCodeAt(pos++);\n        if ((value & 0xffffff80) === 0) {\n            // 1-byte\n            byteLength++;\n            continue;\n        }\n        else if ((value & 0xfffff800) === 0) {\n            // 2-bytes\n            byteLength += 2;\n        }\n        else {\n            // handle surrogate pair\n            if (value >= 0xd800 && value <= 0xdbff) {\n                // high surrogate\n                if (pos < strLength) {\n                    var extra = str.charCodeAt(pos);\n                    if ((extra & 0xfc00) === 0xdc00) {\n                        ++pos;\n                        value = ((value & 0x3ff) << 10) + (extra & 0x3ff) + 0x10000;\n                    }\n                }\n            }\n            if ((value & 0xffff0000) === 0) {\n                // 3-byte\n                byteLength += 3;\n            }\n            else {\n                // 4-byte\n                byteLength += 4;\n            }\n        }\n    }\n    return byteLength;\n}\nexport function utf8EncodeJs(str, output, outputOffset) {\n    var strLength = str.length;\n    var offset = outputOffset;\n    var pos = 0;\n    while (pos < strLength) {\n        var value = str.charCodeAt(pos++);\n        if ((value & 0xffffff80) === 0) {\n            // 1-byte\n            output[offset++] = value;\n            continue;\n        }\n        else if ((value & 0xfffff800) === 0) {\n            // 2-bytes\n            output[offset++] = ((value >> 6) & 0x1f) | 0xc0;\n        }\n        else {\n            // handle surrogate pair\n            if (value >= 0xd800 && value <= 0xdbff) {\n                // high surrogate\n                if (pos < strLength) {\n                    var extra = str.charCodeAt(pos);\n                    if ((extra & 0xfc00) === 0xdc00) {\n                        ++pos;\n                        value = ((value & 0x3ff) << 10) + (extra & 0x3ff) + 0x10000;\n                    }\n                }\n            }\n            if ((value & 0xffff0000) === 0) {\n                // 3-byte\n                output[offset++] = ((value >> 12) & 0x0f) | 0xe0;\n                output[offset++] = ((value >> 6) & 0x3f) | 0x80;\n            }\n            else {\n                // 4-byte\n                output[offset++] = ((value >> 18) & 0x07) | 0xf0;\n                output[offset++] = ((value >> 12) & 0x3f) | 0x80;\n                output[offset++] = ((value >> 6) & 0x3f) | 0x80;\n            }\n        }\n        output[offset++] = (value & 0x3f) | 0x80;\n    }\n}\nvar sharedTextEncoder = TEXT_ENCODING_AVAILABLE ? new TextEncoder() : undefined;\nexport var TEXT_ENCODER_THRESHOLD = !TEXT_ENCODING_AVAILABLE\n    ? UINT32_MAX\n    : typeof process !== \"undefined\" && ((_b = process === null || process === void 0 ? void 0 : process.env) === null || _b === void 0 ? void 0 : _b[\"TEXT_ENCODING\"]) !== \"force\"\n        ? 200\n        : 0;\nfunction utf8EncodeTEencode(str, output, outputOffset) {\n    output.set(sharedTextEncoder.encode(str), outputOffset);\n}\nfunction utf8EncodeTEencodeInto(str, output, outputOffset) {\n    sharedTextEncoder.encodeInto(str, output.subarray(outputOffset));\n}\nexport var utf8EncodeTE = (sharedTextEncoder === null || sharedTextEncoder === void 0 ? void 0 : sharedTextEncoder.encodeInto) ? utf8EncodeTEencodeInto : utf8EncodeTEencode;\nvar CHUNK_SIZE = 4096;\nexport function utf8DecodeJs(bytes, inputOffset, byteLength) {\n    var offset = inputOffset;\n    var end = offset + byteLength;\n    var units = [];\n    var result = \"\";\n    while (offset < end) {\n        var byte1 = bytes[offset++];\n        if ((byte1 & 0x80) === 0) {\n            // 1 byte\n            units.push(byte1);\n        }\n        else if ((byte1 & 0xe0) === 0xc0) {\n            // 2 bytes\n            var byte2 = bytes[offset++] & 0x3f;\n            units.push(((byte1 & 0x1f) << 6) | byte2);\n        }\n        else if ((byte1 & 0xf0) === 0xe0) {\n            // 3 bytes\n            var byte2 = bytes[offset++] & 0x3f;\n            var byte3 = bytes[offset++] & 0x3f;\n            units.push(((byte1 & 0x1f) << 12) | (byte2 << 6) | byte3);\n        }\n        else if ((byte1 & 0xf8) === 0xf0) {\n            // 4 bytes\n            var byte2 = bytes[offset++] & 0x3f;\n            var byte3 = bytes[offset++] & 0x3f;\n            var byte4 = bytes[offset++] & 0x3f;\n            var unit = ((byte1 & 0x07) << 0x12) | (byte2 << 0x0c) | (byte3 << 0x06) | byte4;\n            if (unit > 0xffff) {\n                unit -= 0x10000;\n                units.push(((unit >>> 10) & 0x3ff) | 0xd800);\n                unit = 0xdc00 | (unit & 0x3ff);\n            }\n            units.push(unit);\n        }\n        else {\n            units.push(byte1);\n        }\n        if (units.length >= CHUNK_SIZE) {\n            result += String.fromCharCode.apply(String, units);\n            units.length = 0;\n        }\n    }\n    if (units.length > 0) {\n        result += String.fromCharCode.apply(String, units);\n    }\n    return result;\n}\nvar sharedTextDecoder = TEXT_ENCODING_AVAILABLE ? new TextDecoder() : null;\nexport var TEXT_DECODER_THRESHOLD = !TEXT_ENCODING_AVAILABLE\n    ? UINT32_MAX\n    : typeof process !== \"undefined\" && ((_c = process === null || process === void 0 ? void 0 : process.env) === null || _c === void 0 ? void 0 : _c[\"TEXT_DECODER\"]) !== \"force\"\n        ? 200\n        : 0;\nexport function utf8DecodeTD(bytes, inputOffset, byteLength) {\n    var stringBytes = bytes.subarray(inputOffset, inputOffset + byteLength);\n    return sharedTextDecoder.decode(stringBytes);\n}\n//# sourceMappingURL=utf8.mjs.map","// Integer Utility\nexport var UINT32_MAX = 4294967295;\n// DataView extension to handle int64 / uint64,\n// where the actual range is 53-bits integer (a.k.a. safe integer)\nexport function setUint64(view, offset, value) {\n    var high = value / 4294967296;\n    var low = value; // high bits are truncated by DataView\n    view.setUint32(offset, high);\n    view.setUint32(offset + 4, low);\n}\nexport function setInt64(view, offset, value) {\n    var high = Math.floor(value / 4294967296);\n    var low = value; // high bits are truncated by DataView\n    view.setUint32(offset, high);\n    view.setUint32(offset + 4, low);\n}\nexport function getInt64(view, offset) {\n    var high = view.getInt32(offset);\n    var low = view.getUint32(offset + 4);\n    return high * 4294967296 + low;\n}\nexport function getUint64(view, offset) {\n    var high = view.getUint32(offset);\n    var low = view.getUint32(offset + 4);\n    return high * 4294967296 + low;\n}\n//# sourceMappingURL=int.mjs.map","/**\n * ExtData is used to handle Extension Types that are not registered to ExtensionCodec.\n */\nvar ExtData = /** @class */ (function () {\n    function ExtData(type, data) {\n        this.type = type;\n        this.data = data;\n    }\n    return ExtData;\n}());\nexport { ExtData };\n//# sourceMappingURL=ExtData.mjs.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar DecodeError = /** @class */ (function (_super) {\n    __extends(DecodeError, _super);\n    function DecodeError(message) {\n        var _this = _super.call(this, message) || this;\n        // fix the prototype chain in a cross-platform way\n        var proto = Object.create(DecodeError.prototype);\n        Object.setPrototypeOf(_this, proto);\n        Object.defineProperty(_this, \"name\", {\n            configurable: true,\n            enumerable: false,\n            value: DecodeError.name,\n        });\n        return _this;\n    }\n    return DecodeError;\n}(Error));\nexport { DecodeError };\n//# sourceMappingURL=DecodeError.mjs.map","// https://github.com/msgpack/msgpack/blob/master/spec.md#timestamp-extension-type\nimport { DecodeError } from \"./DecodeError.mjs\";\nimport { getInt64, setInt64 } from \"./utils/int.mjs\";\nexport var EXT_TIMESTAMP = -1;\nvar TIMESTAMP32_MAX_SEC = 0x100000000 - 1; // 32-bit unsigned int\nvar TIMESTAMP64_MAX_SEC = 0x400000000 - 1; // 34-bit unsigned int\nexport function encodeTimeSpecToTimestamp(_a) {\n    var sec = _a.sec, nsec = _a.nsec;\n    if (sec >= 0 && nsec >= 0 && sec <= TIMESTAMP64_MAX_SEC) {\n        // Here sec >= 0 && nsec >= 0\n        if (nsec === 0 && sec <= TIMESTAMP32_MAX_SEC) {\n            // timestamp 32 = { sec32 (unsigned) }\n            var rv = new Uint8Array(4);\n            var view = new DataView(rv.buffer);\n            view.setUint32(0, sec);\n            return rv;\n        }\n        else {\n            // timestamp 64 = { nsec30 (unsigned), sec34 (unsigned) }\n            var secHigh = sec / 0x100000000;\n            var secLow = sec & 0xffffffff;\n            var rv = new Uint8Array(8);\n            var view = new DataView(rv.buffer);\n            // nsec30 | secHigh2\n            view.setUint32(0, (nsec << 2) | (secHigh & 0x3));\n            // secLow32\n            view.setUint32(4, secLow);\n            return rv;\n        }\n    }\n    else {\n        // timestamp 96 = { nsec32 (unsigned), sec64 (signed) }\n        var rv = new Uint8Array(12);\n        var view = new DataView(rv.buffer);\n        view.setUint32(0, nsec);\n        setInt64(view, 4, sec);\n        return rv;\n    }\n}\nexport function encodeDateToTimeSpec(date) {\n    var msec = date.getTime();\n    var sec = Math.floor(msec / 1e3);\n    var nsec = (msec - sec * 1e3) * 1e6;\n    // Normalizes { sec, nsec } to ensure nsec is unsigned.\n    var nsecInSec = Math.floor(nsec / 1e9);\n    return {\n        sec: sec + nsecInSec,\n        nsec: nsec - nsecInSec * 1e9,\n    };\n}\nexport function encodeTimestampExtension(object) {\n    if (object instanceof Date) {\n        var timeSpec = encodeDateToTimeSpec(object);\n        return encodeTimeSpecToTimestamp(timeSpec);\n    }\n    else {\n        return null;\n    }\n}\nexport function decodeTimestampToTimeSpec(data) {\n    var view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n    // data may be 32, 64, or 96 bits\n    switch (data.byteLength) {\n        case 4: {\n            // timestamp 32 = { sec32 }\n            var sec = view.getUint32(0);\n            var nsec = 0;\n            return { sec: sec, nsec: nsec };\n        }\n        case 8: {\n            // timestamp 64 = { nsec30, sec34 }\n            var nsec30AndSecHigh2 = view.getUint32(0);\n            var secLow32 = view.getUint32(4);\n            var sec = (nsec30AndSecHigh2 & 0x3) * 0x100000000 + secLow32;\n            var nsec = nsec30AndSecHigh2 >>> 2;\n            return { sec: sec, nsec: nsec };\n        }\n        case 12: {\n            // timestamp 96 = { nsec32 (unsigned), sec64 (signed) }\n            var sec = getInt64(view, 4);\n            var nsec = view.getUint32(0);\n            return { sec: sec, nsec: nsec };\n        }\n        default:\n            throw new DecodeError(\"Unrecognized data size for timestamp (expected 4, 8, or 12): \".concat(data.length));\n    }\n}\nexport function decodeTimestampExtension(data) {\n    var timeSpec = decodeTimestampToTimeSpec(data);\n    return new Date(timeSpec.sec * 1e3 + timeSpec.nsec / 1e6);\n}\nexport var timestampExtension = {\n    type: EXT_TIMESTAMP,\n    encode: encodeTimestampExtension,\n    decode: decodeTimestampExtension,\n};\n//# sourceMappingURL=timestamp.mjs.map","// ExtensionCodec to handle MessagePack extensions\nimport { ExtData } from \"./ExtData.mjs\";\nimport { timestampExtension } from \"./timestamp.mjs\";\nvar ExtensionCodec = /** @class */ (function () {\n    function ExtensionCodec() {\n        // built-in extensions\n        this.builtInEncoders = [];\n        this.builtInDecoders = [];\n        // custom extensions\n        this.encoders = [];\n        this.decoders = [];\n        this.register(timestampExtension);\n    }\n    ExtensionCodec.prototype.register = function (_a) {\n        var type = _a.type, encode = _a.encode, decode = _a.decode;\n        if (type >= 0) {\n            // custom extensions\n            this.encoders[type] = encode;\n            this.decoders[type] = decode;\n        }\n        else {\n            // built-in extensions\n            var index = 1 + type;\n            this.builtInEncoders[index] = encode;\n            this.builtInDecoders[index] = decode;\n        }\n    };\n    ExtensionCodec.prototype.tryToEncode = function (object, context) {\n        // built-in extensions\n        for (var i = 0; i < this.builtInEncoders.length; i++) {\n            var encodeExt = this.builtInEncoders[i];\n            if (encodeExt != null) {\n                var data = encodeExt(object, context);\n                if (data != null) {\n                    var type = -1 - i;\n                    return new ExtData(type, data);\n                }\n            }\n        }\n        // custom extensions\n        for (var i = 0; i < this.encoders.length; i++) {\n            var encodeExt = this.encoders[i];\n            if (encodeExt != null) {\n                var data = encodeExt(object, context);\n                if (data != null) {\n                    var type = i;\n                    return new ExtData(type, data);\n                }\n            }\n        }\n        if (object instanceof ExtData) {\n            // to keep ExtData as is\n            return object;\n        }\n        return null;\n    };\n    ExtensionCodec.prototype.decode = function (data, type, context) {\n        var decodeExt = type < 0 ? this.builtInDecoders[-1 - type] : this.decoders[type];\n        if (decodeExt) {\n            return decodeExt(data, type, context);\n        }\n        else {\n            // decode() does not fail, returns ExtData instead.\n            return new ExtData(type, data);\n        }\n    };\n    ExtensionCodec.defaultCodec = new ExtensionCodec();\n    return ExtensionCodec;\n}());\nexport { ExtensionCodec };\n//# sourceMappingURL=ExtensionCodec.mjs.map","export function ensureUint8Array(buffer) {\n    if (buffer instanceof Uint8Array) {\n        return buffer;\n    }\n    else if (ArrayBuffer.isView(buffer)) {\n        return new Uint8Array(buffer.buffer, buffer.byteOffset, buffer.byteLength);\n    }\n    else if (buffer instanceof ArrayBuffer) {\n        return new Uint8Array(buffer);\n    }\n    else {\n        // ArrayLike<number>\n        return Uint8Array.from(buffer);\n    }\n}\nexport function createDataView(buffer) {\n    if (buffer instanceof ArrayBuffer) {\n        return new DataView(buffer);\n    }\n    var bufferView = ensureUint8Array(buffer);\n    return new DataView(bufferView.buffer, bufferView.byteOffset, bufferView.byteLength);\n}\n//# sourceMappingURL=typedArrays.mjs.map","export function prettyByte(byte) {\n    return \"\".concat(byte < 0 ? \"-\" : \"\", \"0x\").concat(Math.abs(byte).toString(16).padStart(2, \"0\"));\n}\n//# sourceMappingURL=prettyByte.mjs.map","import { utf8DecodeJs } from \"./utils/utf8.mjs\";\nvar DEFAULT_MAX_KEY_LENGTH = 16;\nvar DEFAULT_MAX_LENGTH_PER_KEY = 16;\nvar CachedKeyDecoder = /** @class */ (function () {\n    function CachedKeyDecoder(maxKeyLength, maxLengthPerKey) {\n        if (maxKeyLength === void 0) { maxKeyLength = DEFAULT_MAX_KEY_LENGTH; }\n        if (maxLengthPerKey === void 0) { maxLengthPerKey = DEFAULT_MAX_LENGTH_PER_KEY; }\n        this.maxKeyLength = maxKeyLength;\n        this.maxLengthPerKey = maxLengthPerKey;\n        this.hit = 0;\n        this.miss = 0;\n        // avoid `new Array(N)`, which makes a sparse array,\n        // because a sparse array is typically slower than a non-sparse array.\n        this.caches = [];\n        for (var i = 0; i < this.maxKeyLength; i++) {\n            this.caches.push([]);\n        }\n    }\n    CachedKeyDecoder.prototype.canBeCached = function (byteLength) {\n        return byteLength > 0 && byteLength <= this.maxKeyLength;\n    };\n    CachedKeyDecoder.prototype.find = function (bytes, inputOffset, byteLength) {\n        var records = this.caches[byteLength - 1];\n        FIND_CHUNK: for (var _i = 0, records_1 = records; _i < records_1.length; _i++) {\n            var record = records_1[_i];\n            var recordBytes = record.bytes;\n            for (var j = 0; j < byteLength; j++) {\n                if (recordBytes[j] !== bytes[inputOffset + j]) {\n                    continue FIND_CHUNK;\n                }\n            }\n            return record.str;\n        }\n        return null;\n    };\n    CachedKeyDecoder.prototype.store = function (bytes, value) {\n        var records = this.caches[bytes.length - 1];\n        var record = { bytes: bytes, str: value };\n        if (records.length >= this.maxLengthPerKey) {\n            // `records` are full!\n            // Set `record` to an arbitrary position.\n            records[(Math.random() * records.length) | 0] = record;\n        }\n        else {\n            records.push(record);\n        }\n    };\n    CachedKeyDecoder.prototype.decode = function (bytes, inputOffset, byteLength) {\n        var cachedValue = this.find(bytes, inputOffset, byteLength);\n        if (cachedValue != null) {\n            this.hit++;\n            return cachedValue;\n        }\n        this.miss++;\n        var str = utf8DecodeJs(bytes, inputOffset, byteLength);\n        // Ensure to copy a slice of bytes because the byte may be NodeJS Buffer and Buffer#slice() returns a reference to its internal ArrayBuffer.\n        var slicedCopyOfBytes = Uint8Array.prototype.slice.call(bytes, inputOffset, inputOffset + byteLength);\n        this.store(slicedCopyOfBytes, str);\n        return str;\n    };\n    return CachedKeyDecoder;\n}());\nexport { CachedKeyDecoder };\n//# sourceMappingURL=CachedKeyDecoder.mjs.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __asyncValues = (this && this.__asyncValues) || function (o) {\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n    var m = o[Symbol.asyncIterator], i;\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n};\nvar __await = (this && this.__await) || function (v) { return this instanceof __await ? (this.v = v, this) : new __await(v); }\nvar __asyncGenerator = (this && this.__asyncGenerator) || function (thisArg, _arguments, generator) {\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n    function fulfill(value) { resume(\"next\", value); }\n    function reject(value) { resume(\"throw\", value); }\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n};\nimport { prettyByte } from \"./utils/prettyByte.mjs\";\nimport { ExtensionCodec } from \"./ExtensionCodec.mjs\";\nimport { getInt64, getUint64, UINT32_MAX } from \"./utils/int.mjs\";\nimport { utf8DecodeJs, TEXT_DECODER_THRESHOLD, utf8DecodeTD } from \"./utils/utf8.mjs\";\nimport { createDataView, ensureUint8Array } from \"./utils/typedArrays.mjs\";\nimport { CachedKeyDecoder } from \"./CachedKeyDecoder.mjs\";\nimport { DecodeError } from \"./DecodeError.mjs\";\nvar isValidMapKeyType = function (key) {\n    var keyType = typeof key;\n    return keyType === \"string\" || keyType === \"number\";\n};\nvar HEAD_BYTE_REQUIRED = -1;\nvar EMPTY_VIEW = new DataView(new ArrayBuffer(0));\nvar EMPTY_BYTES = new Uint8Array(EMPTY_VIEW.buffer);\n// IE11: Hack to support IE11.\n// IE11: Drop this hack and just use RangeError when IE11 is obsolete.\nexport var DataViewIndexOutOfBoundsError = (function () {\n    try {\n        // IE11: The spec says it should throw RangeError,\n        // IE11: but in IE11 it throws TypeError.\n        EMPTY_VIEW.getInt8(0);\n    }\n    catch (e) {\n        return e.constructor;\n    }\n    throw new Error(\"never reached\");\n})();\nvar MORE_DATA = new DataViewIndexOutOfBoundsError(\"Insufficient data\");\nvar sharedCachedKeyDecoder = new CachedKeyDecoder();\nvar Decoder = /** @class */ (function () {\n    function Decoder(extensionCodec, context, maxStrLength, maxBinLength, maxArrayLength, maxMapLength, maxExtLength, keyDecoder) {\n        if (extensionCodec === void 0) { extensionCodec = ExtensionCodec.defaultCodec; }\n        if (context === void 0) { context = undefined; }\n        if (maxStrLength === void 0) { maxStrLength = UINT32_MAX; }\n        if (maxBinLength === void 0) { maxBinLength = UINT32_MAX; }\n        if (maxArrayLength === void 0) { maxArrayLength = UINT32_MAX; }\n        if (maxMapLength === void 0) { maxMapLength = UINT32_MAX; }\n        if (maxExtLength === void 0) { maxExtLength = UINT32_MAX; }\n        if (keyDecoder === void 0) { keyDecoder = sharedCachedKeyDecoder; }\n        this.extensionCodec = extensionCodec;\n        this.context = context;\n        this.maxStrLength = maxStrLength;\n        this.maxBinLength = maxBinLength;\n        this.maxArrayLength = maxArrayLength;\n        this.maxMapLength = maxMapLength;\n        this.maxExtLength = maxExtLength;\n        this.keyDecoder = keyDecoder;\n        this.totalPos = 0;\n        this.pos = 0;\n        this.view = EMPTY_VIEW;\n        this.bytes = EMPTY_BYTES;\n        this.headByte = HEAD_BYTE_REQUIRED;\n        this.stack = [];\n    }\n    Decoder.prototype.reinitializeState = function () {\n        this.totalPos = 0;\n        this.headByte = HEAD_BYTE_REQUIRED;\n        this.stack.length = 0;\n        // view, bytes, and pos will be re-initialized in setBuffer()\n    };\n    Decoder.prototype.setBuffer = function (buffer) {\n        this.bytes = ensureUint8Array(buffer);\n        this.view = createDataView(this.bytes);\n        this.pos = 0;\n    };\n    Decoder.prototype.appendBuffer = function (buffer) {\n        if (this.headByte === HEAD_BYTE_REQUIRED && !this.hasRemaining(1)) {\n            this.setBuffer(buffer);\n        }\n        else {\n            var remainingData = this.bytes.subarray(this.pos);\n            var newData = ensureUint8Array(buffer);\n            // concat remainingData + newData\n            var newBuffer = new Uint8Array(remainingData.length + newData.length);\n            newBuffer.set(remainingData);\n            newBuffer.set(newData, remainingData.length);\n            this.setBuffer(newBuffer);\n        }\n    };\n    Decoder.prototype.hasRemaining = function (size) {\n        return this.view.byteLength - this.pos >= size;\n    };\n    Decoder.prototype.createExtraByteError = function (posToShow) {\n        var _a = this, view = _a.view, pos = _a.pos;\n        return new RangeError(\"Extra \".concat(view.byteLength - pos, \" of \").concat(view.byteLength, \" byte(s) found at buffer[\").concat(posToShow, \"]\"));\n    };\n    /**\n     * @throws {DecodeError}\n     * @throws {RangeError}\n     */\n    Decoder.prototype.decode = function (buffer) {\n        this.reinitializeState();\n        this.setBuffer(buffer);\n        var object = this.doDecodeSync();\n        if (this.hasRemaining(1)) {\n            throw this.createExtraByteError(this.pos);\n        }\n        return object;\n    };\n    Decoder.prototype.decodeMulti = function (buffer) {\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    this.reinitializeState();\n                    this.setBuffer(buffer);\n                    _a.label = 1;\n                case 1:\n                    if (!this.hasRemaining(1)) return [3 /*break*/, 3];\n                    return [4 /*yield*/, this.doDecodeSync()];\n                case 2:\n                    _a.sent();\n                    return [3 /*break*/, 1];\n                case 3: return [2 /*return*/];\n            }\n        });\n    };\n    Decoder.prototype.decodeAsync = function (stream) {\n        var stream_1, stream_1_1;\n        var e_1, _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var decoded, object, buffer, e_1_1, _b, headByte, pos, totalPos;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        decoded = false;\n                        _c.label = 1;\n                    case 1:\n                        _c.trys.push([1, 6, 7, 12]);\n                        stream_1 = __asyncValues(stream);\n                        _c.label = 2;\n                    case 2: return [4 /*yield*/, stream_1.next()];\n                    case 3:\n                        if (!(stream_1_1 = _c.sent(), !stream_1_1.done)) return [3 /*break*/, 5];\n                        buffer = stream_1_1.value;\n                        if (decoded) {\n                            throw this.createExtraByteError(this.totalPos);\n                        }\n                        this.appendBuffer(buffer);\n                        try {\n                            object = this.doDecodeSync();\n                            decoded = true;\n                        }\n                        catch (e) {\n                            if (!(e instanceof DataViewIndexOutOfBoundsError)) {\n                                throw e; // rethrow\n                            }\n                            // fallthrough\n                        }\n                        this.totalPos += this.pos;\n                        _c.label = 4;\n                    case 4: return [3 /*break*/, 2];\n                    case 5: return [3 /*break*/, 12];\n                    case 6:\n                        e_1_1 = _c.sent();\n                        e_1 = { error: e_1_1 };\n                        return [3 /*break*/, 12];\n                    case 7:\n                        _c.trys.push([7, , 10, 11]);\n                        if (!(stream_1_1 && !stream_1_1.done && (_a = stream_1.return))) return [3 /*break*/, 9];\n                        return [4 /*yield*/, _a.call(stream_1)];\n                    case 8:\n                        _c.sent();\n                        _c.label = 9;\n                    case 9: return [3 /*break*/, 11];\n                    case 10:\n                        if (e_1) throw e_1.error;\n                        return [7 /*endfinally*/];\n                    case 11: return [7 /*endfinally*/];\n                    case 12:\n                        if (decoded) {\n                            if (this.hasRemaining(1)) {\n                                throw this.createExtraByteError(this.totalPos);\n                            }\n                            return [2 /*return*/, object];\n                        }\n                        _b = this, headByte = _b.headByte, pos = _b.pos, totalPos = _b.totalPos;\n                        throw new RangeError(\"Insufficient data in parsing \".concat(prettyByte(headByte), \" at \").concat(totalPos, \" (\").concat(pos, \" in the current buffer)\"));\n                }\n            });\n        });\n    };\n    Decoder.prototype.decodeArrayStream = function (stream) {\n        return this.decodeMultiAsync(stream, true);\n    };\n    Decoder.prototype.decodeStream = function (stream) {\n        return this.decodeMultiAsync(stream, false);\n    };\n    Decoder.prototype.decodeMultiAsync = function (stream, isArray) {\n        return __asyncGenerator(this, arguments, function decodeMultiAsync_1() {\n            var isArrayHeaderRequired, arrayItemsLeft, stream_2, stream_2_1, buffer, e_2, e_3_1;\n            var e_3, _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        isArrayHeaderRequired = isArray;\n                        arrayItemsLeft = -1;\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 13, 14, 19]);\n                        stream_2 = __asyncValues(stream);\n                        _b.label = 2;\n                    case 2: return [4 /*yield*/, __await(stream_2.next())];\n                    case 3:\n                        if (!(stream_2_1 = _b.sent(), !stream_2_1.done)) return [3 /*break*/, 12];\n                        buffer = stream_2_1.value;\n                        if (isArray && arrayItemsLeft === 0) {\n                            throw this.createExtraByteError(this.totalPos);\n                        }\n                        this.appendBuffer(buffer);\n                        if (isArrayHeaderRequired) {\n                            arrayItemsLeft = this.readArraySize();\n                            isArrayHeaderRequired = false;\n                            this.complete();\n                        }\n                        _b.label = 4;\n                    case 4:\n                        _b.trys.push([4, 9, , 10]);\n                        _b.label = 5;\n                    case 5:\n                        if (!true) return [3 /*break*/, 8];\n                        return [4 /*yield*/, __await(this.doDecodeSync())];\n                    case 6: return [4 /*yield*/, _b.sent()];\n                    case 7:\n                        _b.sent();\n                        if (--arrayItemsLeft === 0) {\n                            return [3 /*break*/, 8];\n                        }\n                        return [3 /*break*/, 5];\n                    case 8: return [3 /*break*/, 10];\n                    case 9:\n                        e_2 = _b.sent();\n                        if (!(e_2 instanceof DataViewIndexOutOfBoundsError)) {\n                            throw e_2; // rethrow\n                        }\n                        return [3 /*break*/, 10];\n                    case 10:\n                        this.totalPos += this.pos;\n                        _b.label = 11;\n                    case 11: return [3 /*break*/, 2];\n                    case 12: return [3 /*break*/, 19];\n                    case 13:\n                        e_3_1 = _b.sent();\n                        e_3 = { error: e_3_1 };\n                        return [3 /*break*/, 19];\n                    case 14:\n                        _b.trys.push([14, , 17, 18]);\n                        if (!(stream_2_1 && !stream_2_1.done && (_a = stream_2.return))) return [3 /*break*/, 16];\n                        return [4 /*yield*/, __await(_a.call(stream_2))];\n                    case 15:\n                        _b.sent();\n                        _b.label = 16;\n                    case 16: return [3 /*break*/, 18];\n                    case 17:\n                        if (e_3) throw e_3.error;\n                        return [7 /*endfinally*/];\n                    case 18: return [7 /*endfinally*/];\n                    case 19: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Decoder.prototype.doDecodeSync = function () {\n        DECODE: while (true) {\n            var headByte = this.readHeadByte();\n            var object = void 0;\n            if (headByte >= 0xe0) {\n                // negative fixint (111x xxxx) 0xe0 - 0xff\n                object = headByte - 0x100;\n            }\n            else if (headByte < 0xc0) {\n                if (headByte < 0x80) {\n                    // positive fixint (0xxx xxxx) 0x00 - 0x7f\n                    object = headByte;\n                }\n                else if (headByte < 0x90) {\n                    // fixmap (1000 xxxx) 0x80 - 0x8f\n                    var size = headByte - 0x80;\n                    if (size !== 0) {\n                        this.pushMapState(size);\n                        this.complete();\n                        continue DECODE;\n                    }\n                    else {\n                        object = {};\n                    }\n                }\n                else if (headByte < 0xa0) {\n                    // fixarray (1001 xxxx) 0x90 - 0x9f\n                    var size = headByte - 0x90;\n                    if (size !== 0) {\n                        this.pushArrayState(size);\n                        this.complete();\n                        continue DECODE;\n                    }\n                    else {\n                        object = [];\n                    }\n                }\n                else {\n                    // fixstr (101x xxxx) 0xa0 - 0xbf\n                    var byteLength = headByte - 0xa0;\n                    object = this.decodeUtf8String(byteLength, 0);\n                }\n            }\n            else if (headByte === 0xc0) {\n                // nil\n                object = null;\n            }\n            else if (headByte === 0xc2) {\n                // false\n                object = false;\n            }\n            else if (headByte === 0xc3) {\n                // true\n                object = true;\n            }\n            else if (headByte === 0xca) {\n                // float 32\n                object = this.readF32();\n            }\n            else if (headByte === 0xcb) {\n                // float 64\n                object = this.readF64();\n            }\n            else if (headByte === 0xcc) {\n                // uint 8\n                object = this.readU8();\n            }\n            else if (headByte === 0xcd) {\n                // uint 16\n                object = this.readU16();\n            }\n            else if (headByte === 0xce) {\n                // uint 32\n                object = this.readU32();\n            }\n            else if (headByte === 0xcf) {\n                // uint 64\n                object = this.readU64();\n            }\n            else if (headByte === 0xd0) {\n                // int 8\n                object = this.readI8();\n            }\n            else if (headByte === 0xd1) {\n                // int 16\n                object = this.readI16();\n            }\n            else if (headByte === 0xd2) {\n                // int 32\n                object = this.readI32();\n            }\n            else if (headByte === 0xd3) {\n                // int 64\n                object = this.readI64();\n            }\n            else if (headByte === 0xd9) {\n                // str 8\n                var byteLength = this.lookU8();\n                object = this.decodeUtf8String(byteLength, 1);\n            }\n            else if (headByte === 0xda) {\n                // str 16\n                var byteLength = this.lookU16();\n                object = this.decodeUtf8String(byteLength, 2);\n            }\n            else if (headByte === 0xdb) {\n                // str 32\n                var byteLength = this.lookU32();\n                object = this.decodeUtf8String(byteLength, 4);\n            }\n            else if (headByte === 0xdc) {\n                // array 16\n                var size = this.readU16();\n                if (size !== 0) {\n                    this.pushArrayState(size);\n                    this.complete();\n                    continue DECODE;\n                }\n                else {\n                    object = [];\n                }\n            }\n            else if (headByte === 0xdd) {\n                // array 32\n                var size = this.readU32();\n                if (size !== 0) {\n                    this.pushArrayState(size);\n                    this.complete();\n                    continue DECODE;\n                }\n                else {\n                    object = [];\n                }\n            }\n            else if (headByte === 0xde) {\n                // map 16\n                var size = this.readU16();\n                if (size !== 0) {\n                    this.pushMapState(size);\n                    this.complete();\n                    continue DECODE;\n                }\n                else {\n                    object = {};\n                }\n            }\n            else if (headByte === 0xdf) {\n                // map 32\n                var size = this.readU32();\n                if (size !== 0) {\n                    this.pushMapState(size);\n                    this.complete();\n                    continue DECODE;\n                }\n                else {\n                    object = {};\n                }\n            }\n            else if (headByte === 0xc4) {\n                // bin 8\n                var size = this.lookU8();\n                object = this.decodeBinary(size, 1);\n            }\n            else if (headByte === 0xc5) {\n                // bin 16\n                var size = this.lookU16();\n                object = this.decodeBinary(size, 2);\n            }\n            else if (headByte === 0xc6) {\n                // bin 32\n                var size = this.lookU32();\n                object = this.decodeBinary(size, 4);\n            }\n            else if (headByte === 0xd4) {\n                // fixext 1\n                object = this.decodeExtension(1, 0);\n            }\n            else if (headByte === 0xd5) {\n                // fixext 2\n                object = this.decodeExtension(2, 0);\n            }\n            else if (headByte === 0xd6) {\n                // fixext 4\n                object = this.decodeExtension(4, 0);\n            }\n            else if (headByte === 0xd7) {\n                // fixext 8\n                object = this.decodeExtension(8, 0);\n            }\n            else if (headByte === 0xd8) {\n                // fixext 16\n                object = this.decodeExtension(16, 0);\n            }\n            else if (headByte === 0xc7) {\n                // ext 8\n                var size = this.lookU8();\n                object = this.decodeExtension(size, 1);\n            }\n            else if (headByte === 0xc8) {\n                // ext 16\n                var size = this.lookU16();\n                object = this.decodeExtension(size, 2);\n            }\n            else if (headByte === 0xc9) {\n                // ext 32\n                var size = this.lookU32();\n                object = this.decodeExtension(size, 4);\n            }\n            else {\n                throw new DecodeError(\"Unrecognized type byte: \".concat(prettyByte(headByte)));\n            }\n            this.complete();\n            var stack = this.stack;\n            while (stack.length > 0) {\n                // arrays and maps\n                var state = stack[stack.length - 1];\n                if (state.type === 0 /* ARRAY */) {\n                    state.array[state.position] = object;\n                    state.position++;\n                    if (state.position === state.size) {\n                        stack.pop();\n                        object = state.array;\n                    }\n                    else {\n                        continue DECODE;\n                    }\n                }\n                else if (state.type === 1 /* MAP_KEY */) {\n                    if (!isValidMapKeyType(object)) {\n                        throw new DecodeError(\"The type of key must be string or number but \" + typeof object);\n                    }\n                    if (object === \"__proto__\") {\n                        throw new DecodeError(\"The key __proto__ is not allowed\");\n                    }\n                    state.key = object;\n                    state.type = 2 /* MAP_VALUE */;\n                    continue DECODE;\n                }\n                else {\n                    // it must be `state.type === State.MAP_VALUE` here\n                    state.map[state.key] = object;\n                    state.readCount++;\n                    if (state.readCount === state.size) {\n                        stack.pop();\n                        object = state.map;\n                    }\n                    else {\n                        state.key = null;\n                        state.type = 1 /* MAP_KEY */;\n                        continue DECODE;\n                    }\n                }\n            }\n            return object;\n        }\n    };\n    Decoder.prototype.readHeadByte = function () {\n        if (this.headByte === HEAD_BYTE_REQUIRED) {\n            this.headByte = this.readU8();\n            // console.log(\"headByte\", prettyByte(this.headByte));\n        }\n        return this.headByte;\n    };\n    Decoder.prototype.complete = function () {\n        this.headByte = HEAD_BYTE_REQUIRED;\n    };\n    Decoder.prototype.readArraySize = function () {\n        var headByte = this.readHeadByte();\n        switch (headByte) {\n            case 0xdc:\n                return this.readU16();\n            case 0xdd:\n                return this.readU32();\n            default: {\n                if (headByte < 0xa0) {\n                    return headByte - 0x90;\n                }\n                else {\n                    throw new DecodeError(\"Unrecognized array type byte: \".concat(prettyByte(headByte)));\n                }\n            }\n        }\n    };\n    Decoder.prototype.pushMapState = function (size) {\n        if (size > this.maxMapLength) {\n            throw new DecodeError(\"Max length exceeded: map length (\".concat(size, \") > maxMapLengthLength (\").concat(this.maxMapLength, \")\"));\n        }\n        this.stack.push({\n            type: 1 /* MAP_KEY */,\n            size: size,\n            key: null,\n            readCount: 0,\n            map: {},\n        });\n    };\n    Decoder.prototype.pushArrayState = function (size) {\n        if (size > this.maxArrayLength) {\n            throw new DecodeError(\"Max length exceeded: array length (\".concat(size, \") > maxArrayLength (\").concat(this.maxArrayLength, \")\"));\n        }\n        this.stack.push({\n            type: 0 /* ARRAY */,\n            size: size,\n            array: new Array(size),\n            position: 0,\n        });\n    };\n    Decoder.prototype.decodeUtf8String = function (byteLength, headerOffset) {\n        var _a;\n        if (byteLength > this.maxStrLength) {\n            throw new DecodeError(\"Max length exceeded: UTF-8 byte length (\".concat(byteLength, \") > maxStrLength (\").concat(this.maxStrLength, \")\"));\n        }\n        if (this.bytes.byteLength < this.pos + headerOffset + byteLength) {\n            throw MORE_DATA;\n        }\n        var offset = this.pos + headerOffset;\n        var object;\n        if (this.stateIsMapKey() && ((_a = this.keyDecoder) === null || _a === void 0 ? void 0 : _a.canBeCached(byteLength))) {\n            object = this.keyDecoder.decode(this.bytes, offset, byteLength);\n        }\n        else if (byteLength > TEXT_DECODER_THRESHOLD) {\n            object = utf8DecodeTD(this.bytes, offset, byteLength);\n        }\n        else {\n            object = utf8DecodeJs(this.bytes, offset, byteLength);\n        }\n        this.pos += headerOffset + byteLength;\n        return object;\n    };\n    Decoder.prototype.stateIsMapKey = function () {\n        if (this.stack.length > 0) {\n            var state = this.stack[this.stack.length - 1];\n            return state.type === 1 /* MAP_KEY */;\n        }\n        return false;\n    };\n    Decoder.prototype.decodeBinary = function (byteLength, headOffset) {\n        if (byteLength > this.maxBinLength) {\n            throw new DecodeError(\"Max length exceeded: bin length (\".concat(byteLength, \") > maxBinLength (\").concat(this.maxBinLength, \")\"));\n        }\n        if (!this.hasRemaining(byteLength + headOffset)) {\n            throw MORE_DATA;\n        }\n        var offset = this.pos + headOffset;\n        var object = this.bytes.subarray(offset, offset + byteLength);\n        this.pos += headOffset + byteLength;\n        return object;\n    };\n    Decoder.prototype.decodeExtension = function (size, headOffset) {\n        if (size > this.maxExtLength) {\n            throw new DecodeError(\"Max length exceeded: ext length (\".concat(size, \") > maxExtLength (\").concat(this.maxExtLength, \")\"));\n        }\n        var extType = this.view.getInt8(this.pos + headOffset);\n        var data = this.decodeBinary(size, headOffset + 1 /* extType */);\n        return this.extensionCodec.decode(data, extType, this.context);\n    };\n    Decoder.prototype.lookU8 = function () {\n        return this.view.getUint8(this.pos);\n    };\n    Decoder.prototype.lookU16 = function () {\n        return this.view.getUint16(this.pos);\n    };\n    Decoder.prototype.lookU32 = function () {\n        return this.view.getUint32(this.pos);\n    };\n    Decoder.prototype.readU8 = function () {\n        var value = this.view.getUint8(this.pos);\n        this.pos++;\n        return value;\n    };\n    Decoder.prototype.readI8 = function () {\n        var value = this.view.getInt8(this.pos);\n        this.pos++;\n        return value;\n    };\n    Decoder.prototype.readU16 = function () {\n        var value = this.view.getUint16(this.pos);\n        this.pos += 2;\n        return value;\n    };\n    Decoder.prototype.readI16 = function () {\n        var value = this.view.getInt16(this.pos);\n        this.pos += 2;\n        return value;\n    };\n    Decoder.prototype.readU32 = function () {\n        var value = this.view.getUint32(this.pos);\n        this.pos += 4;\n        return value;\n    };\n    Decoder.prototype.readI32 = function () {\n        var value = this.view.getInt32(this.pos);\n        this.pos += 4;\n        return value;\n    };\n    Decoder.prototype.readU64 = function () {\n        var value = getUint64(this.view, this.pos);\n        this.pos += 8;\n        return value;\n    };\n    Decoder.prototype.readI64 = function () {\n        var value = getInt64(this.view, this.pos);\n        this.pos += 8;\n        return value;\n    };\n    Decoder.prototype.readF32 = function () {\n        var value = this.view.getFloat32(this.pos);\n        this.pos += 4;\n        return value;\n    };\n    Decoder.prototype.readF64 = function () {\n        var value = this.view.getFloat64(this.pos);\n        this.pos += 8;\n        return value;\n    };\n    return Decoder;\n}());\nexport { Decoder };\n//# sourceMappingURL=Decoder.mjs.map","import { Decoder } from \"./Decoder.mjs\";\nexport var defaultDecodeOptions = {};\n/**\n * It decodes a single MessagePack object in a buffer.\n *\n * This is a synchronous decoding function.\n * See other variants for asynchronous decoding: {@link decodeAsync()}, {@link decodeStream()}, or {@link decodeArrayStream()}.\n */\nexport function decode(buffer, options) {\n    if (options === void 0) { options = defaultDecodeOptions; }\n    var decoder = new Decoder(options.extensionCodec, options.context, options.maxStrLength, options.maxBinLength, options.maxArrayLength, options.maxMapLength, options.maxExtLength);\n    return decoder.decode(buffer);\n}\n/**\n * It decodes multiple MessagePack objects in a buffer.\n * This is corresponding to {@link decodeMultiStream()}.\n */\nexport function decodeMulti(buffer, options) {\n    if (options === void 0) { options = defaultDecodeOptions; }\n    var decoder = new Decoder(options.extensionCodec, options.context, options.maxStrLength, options.maxBinLength, options.maxArrayLength, options.maxMapLength, options.maxExtLength);\n    return decoder.decodeMulti(buffer);\n}\n//# sourceMappingURL=decode.mjs.map","import { xpathToElement, xpathToElementArray, dispatch } from './utils'\n\nimport ActiveElement from './active_element'\nimport OperationStore from './operation_store'\nimport { decode } from '@msgpack/msgpack'\n\nconst perform = (\n  operations,\n  options = { emitMissingElementWarnings: true }\n) => {\n  const batches = {}\n  operations = decode(operations)\n  operations.forEach(operation => {\n    if (!!operation.batch)\n      batches[operation.batch] = batches[operation.batch]\n        ? ++batches[operation.batch]\n        : 1\n  })\n  operations.forEach(operation => {\n    const name = operation.operation\n    try {\n      if (operation.selector) {\n        if (operation.xpath) {\n          operation.element = operation.selectAll\n            ? xpathToElementArray(operation.selector)\n            : xpathToElement(operation.selector)\n        } else {\n          operation.element = operation.selectAll\n            ? document.querySelectorAll(operation.selector)\n            : document.querySelector(operation.selector)\n        }\n      } else {\n        operation.element = document\n      }\n      if (operation.element || options.emitMissingElementWarnings) {\n        ActiveElement.set(document.activeElement)\n        const cableReadyOperation = OperationStore.all[name]\n\n        if (cableReadyOperation) {\n          cableReadyOperation(operation)\n          if (!!operation.batch && --batches[operation.batch] === 0)\n            dispatch(document, 'cable-ready:batch-complete', {\n              batch: operation.batch\n            })\n        } else {\n          console.error(\n            `CableReady couldn't find the \"${name}\" operation. Make sure you use the camelized form when calling an operation method.`\n          )\n        }\n      }\n    } catch (e) {\n      if (operation.element) {\n        console.error(\n          `CableReady detected an error in ${name || 'operation'}: ${\n            e.message\n          }. If you need to support older browsers make sure you've included the corresponding polyfills. https://docs.stimulusreflex.com/setup#polyfills-for-ie11.`\n        )\n        console.error(e)\n      } else {\n        console.warn(\n          `CableReady ${name ||\n            'operation'} failed due to missing DOM element for selector: '${\n            operation.selector\n          }'`\n        )\n      }\n    }\n  })\n}\n\nconst performAsync = (\n  operations,\n  options = { emitMissingElementWarnings: true }\n) => {\n  return new Promise((resolve, reject) => {\n    try {\n      resolve(perform(operations, options))\n    } catch (err) {\n      reject(err)\n    }\n  })\n}\n\nexport { perform, performAsync }\n","let consumer\n\nconst BACKOFF = [25, 50, 75, 100, 200, 250, 500, 800, 1000, 2000]\n\nconst wait = (ms) => new Promise(resolve => setTimeout(resolve, ms))\n\nconst getConsumerWithRetry = async (retry = 0) => {\n  if (consumer) return consumer\n\n  if (retry >= BACKOFF.length) {\n    throw new Error(\"Couldn't obtain a Action Cable consumer within 5s\")\n  }\n\n  await wait(BACKOFF[retry])\n\n  return await getConsumerWithRetry(retry + 1)\n}\n\nexport default {\n  setConsumer (value) {\n    consumer = value\n  },\n\n  get consumer () {\n    return consumer\n  },\n\n  async getConsumer () {\n    return await getConsumerWithRetry()\n  }\n}\n","import { perform } from '../cable_ready'\n\nexport default class CableReadyElement extends HTMLElement {\n  static define () {\n    if (!customElements.get('cable-ready')) {\n      customElements.define('cable-ready', this)\n    }\n  }\n\n  connectedCallback () {\n    setTimeout(() => {\n      try {\n        const operations = JSON.parse(this.scriptElement.textContent)\n        perform(operations)\n      } catch (error) {\n        console.error(error)\n      } finally {\n        try {\n          this.remove()\n        } catch {}\n      }\n    })\n  }\n\n  get scriptElement () {\n    if (\n      this.firstElementChild instanceof HTMLScriptElement &&\n      this.firstElementChild.getAttribute('type') === 'application/json'\n    ) {\n      return this.firstElementChild\n    }\n    throw new Error(\n      'First child element in a `<cable-ready>` tag must be `<script type=\"application/json\">`.'\n    )\n  }\n}\n","export default class SubscribingElement extends HTMLElement {\n  disconnectedCallback () {\n    if (this.channel) this.channel.unsubscribe()\n  }\n\n  createSubscription (consumer, channel, receivedCallback) {\n    this.channel = consumer.subscriptions.create(\n      {\n        channel,\n        identifier: this.identifier\n      },\n      {\n        received: receivedCallback\n      }\n    )\n  }\n\n  get preview () {\n    return (\n      document.documentElement.hasAttribute('data-turbolinks-preview') ||\n      document.documentElement.hasAttribute('data-turbo-preview')\n    )\n  }\n\n  get identifier () {\n    return this.getAttribute('identifier')\n  }\n}\n","import { perform } from '../cable_ready'\nimport SubscribingElement from './subscribing_element'\nimport CableConsumer from '../cable_consumer'\n\nexport default class StreamFromElement extends SubscribingElement {\n  static define () {\n    if (!customElements.get('stream-from')) {\n      customElements.define('stream-from', this)\n    }\n  }\n\n  async connectedCallback () {\n    if (this.preview) return\n\n    const consumer = await CableConsumer.getConsumer()\n\n    if (consumer) {\n      this.createSubscription(\n        consumer,\n        'CableReady::Stream',\n        this.performOperations\n      )\n    } else {\n      console.error(\n        'The `stream_from` helper cannot connect without an ActionCable consumer.\\nPlease run `rails generate cable_ready:helpers` to fix this.'\n      )\n    }\n  }\n\n  performOperations (data) {\n    if (data.cableReady) perform(data.operations)\n  }\n}\n","import morphdom from 'morphdom'\n\nimport SubscribingElement from './subscribing_element'\n\nimport { shouldMorph } from '../morph_callbacks'\nimport { debounce, assignFocus, dispatch, graciouslyFetch } from '../utils'\n\nimport ActiveElement from '../active_element'\nimport CableConsumer from '../cable_consumer'\n\nconst template = `\n<style>\n  :host {\n    display: block;\n  }\n</style>\n<slot></slot>\n`\n\nfunction url (element) {\n  return element.hasAttribute('url')\n    ? element.getAttribute('url')\n    : location.href\n}\n\nexport default class UpdatesForElement extends SubscribingElement {\n  static define () {\n    if (!customElements.get('updates-for')) {\n      customElements.define('updates-for', this)\n    }\n  }\n\n  constructor () {\n    super()\n    const shadowRoot = this.attachShadow({ mode: 'open' })\n    shadowRoot.innerHTML = template\n  }\n\n  async connectedCallback () {\n    if (this.preview) return\n    this.update = debounce(this.update.bind(this), this.debounce)\n\n    const consumer = await CableConsumer.getConsumer()\n\n    if (consumer) {\n      this.createSubscription(consumer, 'CableReady::Stream', this.update)\n    } else {\n      console.error(\n        'The `updates-for` helper cannot connect without an ActionCable consumer.\\nPlease run `rails generate cable_ready:helpers` to fix this.'\n      )\n    }\n  }\n\n  async update (data) {\n    const blocks = Array.from(\n      document.querySelectorAll(this.query),\n      element => new Block(element)\n    )\n\n    // first updates-for element in the DOM *at any given moment* updates all of the others\n    if (blocks[0].element !== this) return\n\n    // hold a reference to the active element so that it can be restored after the morph\n    ActiveElement.set(document.activeElement)\n\n    // store all retrieved HTML in an object keyed by URL to minimize fetch calls\n    this.html = {}\n\n    const uniqueUrls = [...new Set(blocks.map(block => block.url))]\n\n    await Promise.all(\n      uniqueUrls.map(async url => {\n        if (!this.html.hasOwnProperty(url)) {\n          const response = await graciouslyFetch(url, {\n            'X-Cable-Ready': 'update'\n          })\n          this.html[url] = await response.text()\n        }\n      })\n    )\n\n    // track current block index for each URL; referred to as fragments\n    this.index = {}\n\n    blocks.forEach(block => {\n      // if the block's URL is not in the index, initialize it to 0; otherwise, increment it\n      this.index.hasOwnProperty(block.url)\n        ? this.index[block.url]++\n        : (this.index[block.url] = 0)\n\n      block.process(data, this.html, this.index)\n    })\n  }\n\n  get query () {\n    return `updates-for[identifier=\"${this.identifier}\"]`\n  }\n\n  get identifier () {\n    return this.getAttribute('identifier')\n  }\n\n  get debounce () {\n    return this.hasAttribute('debounce')\n      ? parseInt(this.getAttribute('debounce'))\n      : 20\n  }\n}\n\nclass Block {\n  constructor (element) {\n    this.element = element\n  }\n\n  async process (data, html, index) {\n    // with the index incremented, we can now safely bail - before a fetch - if there's no work to be done\n    if (!this.shouldUpdate(data)) return\n\n    const blockIndex = index[this.url]\n    const template = document.createElement('template')\n    this.element.setAttribute('updating', 'updating')\n\n    template.innerHTML = String(html[this.url]).trim()\n\n    await this.resolveTurboFrames(template.content)\n\n    const fragments = template.content.querySelectorAll(this.query)\n\n    if (fragments.length <= blockIndex) {\n      console.warn(\n        `Update aborted due to insufficient number of elements. The offending url is ${this.url}.`\n      )\n      return\n    }\n\n    const operation = {\n      element: this.element,\n      html: fragments[blockIndex],\n      permanentAttributeName: 'data-ignore-updates'\n    }\n\n    dispatch(this.element, 'cable-ready:before-update', operation)\n    morphdom(this.element, fragments[blockIndex], {\n      childrenOnly: true,\n      onBeforeElUpdated: shouldMorph(operation),\n      onElUpdated: _ => {\n        this.element.removeAttribute('updating')\n        dispatch(this.element, 'cable-ready:after-update', operation)\n        assignFocus(operation.focusSelector)\n      }\n    })\n  }\n\n  async resolveTurboFrames (documentFragment) {\n    const reloadingTurboFrames = [\n      ...documentFragment.querySelectorAll(\n        'turbo-frame[src]:not([loading=\"lazy\"])'\n      )\n    ]\n\n    return Promise.all(\n      reloadingTurboFrames.map(frame => {\n        return new Promise(async resolve => {\n          const frameResponse = await graciouslyFetch(\n            frame.getAttribute('src'),\n            {\n              'Turbo-Frame': frame.id,\n              'X-Cable-Ready': 'update'\n            }\n          )\n\n          const frameTemplate = document.createElement('template')\n          frameTemplate.innerHTML = await frameResponse.text()\n\n          // recurse here to get all nested eager loaded frames\n          await this.resolveTurboFrames(frameTemplate.content)\n\n          documentFragment.querySelector(\n            `turbo-frame#${frame.id}`\n          ).innerHTML = String(\n            frameTemplate.content.querySelector(`turbo-frame#${frame.id}`)\n              .innerHTML\n          ).trim()\n\n          resolve()\n        })\n      })\n    )\n  }\n\n  shouldUpdate (data) {\n    // if everything that could prevent an update is false, update this block\n    return !this.ignoresInnerUpdates && this.hasChangesSelectedForUpdate(data)\n  }\n\n  hasChangesSelectedForUpdate (data) {\n    // if there's an only attribute, only update if at least one of the attributes changed is in the allow list\n    const only = this.element.getAttribute('only')\n\n    return !(\n      only &&\n      data.changed &&\n      !only.split(' ').some(attribute => data.changed.includes(attribute))\n    )\n  }\n\n  get ignoresInnerUpdates () {\n    // don't update during a Reflex or Turbolinks redraw\n    return (\n      this.element.hasAttribute('ignore-inner-updates') &&\n      this.element.hasAttribute('performing-inner-update')\n    )\n  }\n\n  get url () {\n    return this.element.hasAttribute('url')\n      ? this.element.getAttribute('url')\n      : location.href\n  }\n\n  get identifier () {\n    return this.element.identifier\n  }\n\n  get query () {\n    return this.element.query\n  }\n}\n","export const registerInnerUpdates = () => {\n  document.addEventListener('stimulus-reflex:before', event => {\n    recursiveMarkUpdatesForElements(event.detail.element)\n  })\n\n  document.addEventListener('stimulus-reflex:after', event => {\n    setTimeout(() => {\n      recursiveUnmarkUpdatesForElements(event.detail.element)\n    })\n  })\n\n  document.addEventListener('turbo:submit-start', event => {\n    recursiveMarkUpdatesForElements(event.target)\n  })\n\n  document.addEventListener('turbo:submit-end', event => {\n    setTimeout(() => {\n      recursiveUnmarkUpdatesForElements(event.target)\n    })\n  })\n}\n\nconst recursiveMarkUpdatesForElements = leaf => {\n  const closestUpdatesFor =\n    leaf && leaf.parentElement && leaf.parentElement.closest('updates-for')\n  if (closestUpdatesFor) {\n    closestUpdatesFor.setAttribute('performing-inner-update', '')\n    recursiveMarkUpdatesForElements(closestUpdatesFor)\n  }\n}\n\nconst recursiveUnmarkUpdatesForElements = leaf => {\n  const closestUpdatesFor =\n    leaf && leaf.parentElement && leaf.parentElement.closest('updates-for')\n  if (closestUpdatesFor) {\n    closestUpdatesFor.removeAttribute('performing-inner-update')\n    recursiveUnmarkUpdatesForElements(closestUpdatesFor)\n  }\n}\n","import packageInfo from '../package.json'\nimport { perform, performAsync } from './cable_ready'\nimport { initialize } from './elements'\nimport { shouldMorphCallbacks, didMorphCallbacks } from './morph_callbacks'\n\nimport * as MorphCallbacks from './morph_callbacks'\nimport * as Utils from './utils'\n\nimport OperationStore, { addOperation, addOperations } from './operation_store'\nimport CableReadyElement from './elements/cable_ready_element'\nimport StreamFromElement from './elements/stream_from_element'\nimport UpdatesForElement from './elements/updates_for_element'\nimport SubscribingElement from './elements/subscribing_element'\nimport CableConsumer from './cable_consumer'\n\nexport {\n  Utils,\n  MorphCallbacks,\n  CableReadyElement,\n  StreamFromElement,\n  UpdatesForElement,\n  SubscribingElement\n}\n\nconst global = {\n  perform,\n  performAsync,\n  shouldMorphCallbacks,\n  didMorphCallbacks,\n  initialize,\n  addOperation,\n  addOperations,\n  version: packageInfo.version,\n  cable: CableConsumer,\n  get DOMOperations () {\n    console.warn(\n      'DEPRECATED: Please use `CableReady.operations` instead of `CableReady.DOMOperations`'\n    )\n    return OperationStore.all\n  },\n  get operations () {\n    return OperationStore.all\n  },\n  get consumer () {\n    return CableConsumer.consumer\n  }\n}\n\nwindow.CableReady = global\n\nexport default global\n","import CableConsumer from '../cable_consumer'\n\nimport CableReadyElement from './cable_ready_element'\nimport StreamFromElement from './stream_from_element'\nimport UpdatesForElement from './updates_for_element'\n\nimport { registerInnerUpdates } from '../updatable/inner_updates_compat'\n\nconst initialize = (initializeOptions = {}) => {\n  const { consumer } = initializeOptions\n\n  registerInnerUpdates()\n\n  if (consumer) {\n    CableConsumer.setConsumer(consumer)\n  } else {\n    console.error(\n      'CableReady requires a reference to your Action Cable `consumer` for its helpers to function.\\nEnsure that you have imported the `CableReady` package as well as `consumer` from your `channels` folder, then call `CableReady.initialize({ consumer })`.'\n    )\n  }\n\n  CableReadyElement.define()\n  StreamFromElement.define()\n  UpdatesForElement.define()\n}\n\nexport { initialize }\n"],"names":["inputTags","INPUT","TEXTAREA","SELECT","mutableTags","OPTION","textInputTypes","color","date","datetime","email","month","number","password","range","search","tel","text","textarea","time","url","week","activeElement","ActiveElement","element","set","isTextInput","tagName","type","assignFocus","selector","focusElement","nodeType","Node","ELEMENT_NODE","document","querySelector","focus","dispatch","name","detail","evt","CustomEvent","bubbles","cancelable","dispatchEvent","window","jQuery","trigger","xpathToElement","xpath","evaluate","XPathResult","FIRST_ORDERED_NODE_TYPE","singleNodeValue","xpathToElementArray","result","ORDERED_NODE_SNAPSHOT_TYPE","elements","i","snapshotLength","push","snapshotItem","getClassNames","names","Array","from","flat","processElements","operation","callback","selectAll","forEach","kebabize","str","split","map","letter","idx","toUpperCase","toLowerCase","join","operate","cancel","delay","setTimeout","before","target","after","debounce","func","timeout","timer","args","clearTimeout","apply","this","handleErrors","response","ok","Error","statusText","safeScalar","val","undefined","includes","console","warn","safeString","String","safeArray","arr","isArray","safeObject","obj","Object","async","graciouslyFetch","additionalHeaders","fetch","headers","e","error","shouldMorph","fromEl","toEl","shouldMorphCallbacks","didMorph","el","didMorphCallbacks","verifyNotMutable","isEqualNode","verifyNotContentEditable","isContentEditable","verifyNotPermanent","permanentAttributeName","permanent","closest","ignore","value","attributes","attribute","setAttribute","Operations","append","html","focusSelector","insertAdjacentHTML","graft","parent","parentElement","appendChild","innerHtml","innerHTML","insertAdjacentHtml","position","insertAdjacentText","morph","template","createElement","trim","content","ordinal","children","indexOf","childrenOnly","morphdom","onBeforeElUpdated","onElUpdated","outerHtml","outerHTML","prepend","remove","replace","textContent","addCssClass","classList","add","removeAttribute","removeCssClass","setDatasetProperty","dataset","setProperty","setStyle","style","setStyles","styles","entries","setValue","invokeMethod","firstObjectInChain","receiver","method","chain","lastObjectInChain","foundMethod","reduce","lastTerm","nextTerm","Function","setMeta","meta","head","clearStorage","sessionStorage","localStorage","clear","go","delta","history","pushState","state","title","redirectTo","action","turbo","Turbo","visit","Turbolinks","location","href","reload","removeStorageItem","key","removeItem","replaceState","scrollIntoView","setCookie","cookie","setFocus","setStorageItem","setItem","consoleLog","message","level","log","consoleTable","data","columns","table","notification","options","Notification","requestPermission","then","permission","operations","newOperations","_a","_b","_c","OperationStore","all","UINT32_MAX","getInt64","view","offset","getInt32","getUint32","TEXT_ENCODING_AVAILABLE","process","env","TextEncoder","TextDecoder","sharedTextEncoder","encodeInto","utf8DecodeJs","bytes","inputOffset","byteLength","end","units","byte1","byte2","byte3","unit","length","fromCharCode","sharedTextDecoder","TEXT_DECODER_THRESHOLD","extendStatics","ExtData","__extends","d","b","setPrototypeOf","__proto__","p","prototype","hasOwnProperty","call","TypeError","__","constructor","create","DecodeError","_super","_this","proto","defineProperty","configurable","enumerable","encodeTimeSpecToTimestamp","sec","nsec","rv","Uint8Array","DataView","buffer","setUint32","secHigh","secLow","high","Math","floor","low","setInt64","timestampExtension","encode","object","msec","nsecInSec","Date","getTime","decode","timeSpec","byteOffset","nsec30AndSecHigh2","concat","decodeTimestampToTimeSpec","ExtensionCodec","builtInEncoders","builtInDecoders","encoders","decoders","register","index","tryToEncode","context","encodeExt","decodeExt","defaultCodec","ensureUint8Array","ArrayBuffer","isView","prettyByte","byte","abs","toString","padStart","CachedKeyDecoder","maxKeyLength","maxLengthPerKey","hit","miss","caches","canBeCached","find","FIND_CHUNK","_i","records_1","record","recordBytes","j","store","records","random","cachedValue","slicedCopyOfBytes","slice","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","done","__generator","body","f","y","t","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","n","v","op","pop","__asyncValues","o","asyncIterator","m","__values","settle","__await","__asyncGenerator","q","a","resume","r","fulfill","shift","EMPTY_VIEW","EMPTY_BYTES","DataViewIndexOutOfBoundsError","getInt8","MORE_DATA","sharedCachedKeyDecoder","Decoder","extensionCodec","maxStrLength","maxBinLength","maxArrayLength","maxMapLength","maxExtLength","keyDecoder","totalPos","pos","headByte","stack","reinitializeState","setBuffer","bufferView","createDataView","appendBuffer","hasRemaining","remainingData","subarray","newData","newBuffer","size","createExtraByteError","posToShow","RangeError","doDecodeSync","decodeMulti","decodeAsync","stream","stream_1","stream_1_1","e_1","decoded","e_1_1","decodeArrayStream","decodeMultiAsync","decodeStream","arguments","isArrayHeaderRequired","arrayItemsLeft","stream_2","stream_2_1","e_2","e_3_1","e_3","readArraySize","complete","DECODE","readHeadByte","pushMapState","pushArrayState","decodeUtf8String","readF32","readF64","readU8","readU16","readU32","readU64","readI8","readI16","readI32","readI64","lookU8","lookU16","lookU32","decodeBinary","decodeExtension","array","keyType","readCount","headerOffset","stateIsMapKey","stringBytes","utf8DecodeTD","headOffset","extType","getUint8","getUint16","getInt16","getFloat32","getFloat64","defaultDecodeOptions","perform","emitMissingElementWarnings","batches","batch","querySelectorAll","cableReadyOperation","consumer","BACKOFF","getConsumerWithRetry","retry","ms","CableConsumer","setConsumer","CableReadyElement","HTMLElement","static","customElements","get","define","connectedCallback","JSON","parse","scriptElement","firstElementChild","HTMLScriptElement","getAttribute","SubscribingElement","disconnectedCallback","channel","unsubscribe","createSubscription","receivedCallback","subscriptions","identifier","received","preview","documentElement","hasAttribute","StreamFromElement","getConsumer","performOperations","cableReady","UpdatesForElement","super","attachShadow","mode","update","bind","blocks","query","Block","uniqueUrls","Set","block","parseInt","shouldUpdate","blockIndex","resolveTurboFrames","fragments","documentFragment","reloadingTurboFrames","frame","frameResponse","id","frameTemplate","ignoresInnerUpdates","hasChangesSelectedForUpdate","only","changed","some","recursiveMarkUpdatesForElements","leaf","closestUpdatesFor","recursiveUnmarkUpdatesForElements","global","performAsync","err","initialize","initializeOptions","addEventListener","event","addOperation","addOperations","version","packageInfo","cable","DOMOperations","CableReady"],"mappings":"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"}